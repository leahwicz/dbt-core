name: Homebrew release

on:
  workflow_dispatch:
    inputs:
      version_number:
       description: 'The version number to bump to'
       required: true
      is_dry_run:
       description: 'Creates a draft PR to allow testing instead of committing to a branch'
       required: true
       default: 'true'  
       
jobs:
  homebrew:
    name: Bump Homebrew formula
    runs-on: ubuntu-latest
    steps:
      - uses: mislav/bump-homebrew-formula-action@v1
        with:
          formula-name: dbt-postgres
          formula-path: Formula/dbt-postgres.rb
          homebrew-tap: dbt-labs/homebrew-dbt
          create-pullrequest: true
          download-url: https://github.com/dbt-labs/dbt-core/releases/download/v${{ github.event.inputs.version_number }}/dbt-postgres-${{ github.event.inputs.version_number }}.tar.gz
          commit-message: |
            {{formulaName}} {{version}}

            Created by https://github.com/mislav/bump-homebrew-formula-action
